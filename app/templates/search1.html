{% extends "layout/base.html" %}

{% block head %}
<link href="{{ url_for('static', filename='css/slider.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="row" style="margin-top:4%; height:95%">
<div class="col-md-3" style="padding:0px;padding-left:20px;height:100%">

<!-- Like field -->
<div class="panel panel-primary panel-success"  style="margin:0px;height: 48%">
    <div class="panel-heading">
        <h3 class="panel-title">Like these domains</h3>
    </div>
    <div class="panel-body">
        <form role="form" action="/search" method="post" name="edit">
        {{add_form.hidden_tag()}}
            <div class="form-group">
                {{add_form.add_pos_domain(size=50, class="form-control", autocomplete='off', value="", id="add_pos_domain", **{'data-provide':'typeahead'})}}
		{{add_form.pos_domains(size=150, class="form-control", type='hidden', autocomplete='off', value = config)}}
            </div>
            <button type="submit" class="btn btn-default" value='submit'><span class="glyphicon glyphicon-plus"></span> Add</button>
        </form>
  	</div>
	{% if config['pos_domains'] %}
	<div class="panel-body" style="height:inherit;overflow:auto">
		{%for line in config['pos_domains'].split(", ") %}
		{% set pos_config = config %}
		{% set _dummy = pos_config.update({'pos_delete':line}) %}
		<form class="form" role="form" action="/search" method="post" name="pos">
		{{add_form.del_pos_domain(size=10, class="form-control", type='hidden', autocomplete='off', value = pos_config)}}		
		<button type="submit" class="btn btn-success" value="submit" style="font-size: 15px; margin-top: 5px">{{line}}<span class="glyphicon glyphicon-remove" style="font-size: 1.3em; vertical-align:middle; margin-left: 10px"></span></button>
		</form>
		{% endfor %}
	</div>
	{% endif %}
</div>

<!-- Unlike field -->
<div class="panel panel-primary panel-danger"  style="margin:0px;height: 48%">
    <div class="panel-heading">
        <h3 class="panel-title">Unlike these domains</h3>
    </div>
    <div class="panel-body">
        <form role="form" action="/search" method="post" name="edit">
        {{add_form.hidden_tag()}}
            <div class="form-group">
                {{add_form.add_neg_domain(size=50, class="form-control", autocomplete='off', value="", id="add_neg_domain", **{'data-provide':'typeahead'})}}
		{{add_form.neg_domains(size=150, class="form-control", type='hidden', autocomplete='off', value = config)}}
            </div>
            <button type="submit" class="btn btn-default" value='submit'><span class="glyphicon glyphicon-plus"></span> Add</button>
        </form>
  	</div>
	{% if config['neg_domains'] %}
	<div class="panel-body" style="height:inherit;overflow:auto">
		{%for line in config['neg_domains'].split(", ") %}
		{% set neg_config = config %}
		{% set _dummy = neg_config.update({'neg_delete':line}) %}
		<form class="form" role="form" action="/search" method="post" name="neg">
		{{add_form.del_neg_domain(size=10, class="form-control", type='hidden', autocomplete='off', value = neg_config )}}		
		<button type="submit" class="btn btn-danger" value="submit" style="font-size: 15px; margin-top: 5px">{{line}}<span class="glyphicon glyphicon-remove" style="font-size: 1.3em; vertical-align:middle; margin-left: 10px"></span></button>
		</form>
		{% endfor %}
	</div>
	{% endif %}
</div>
</div>
{% if data %}
<div class="col-md-3" style="padding:0px;height:100%">
<!-- Label -->
<div class="panel panel-primary"  style="margin:0px;height: 30%">
    <div class="panel-heading">
        <h3 class="panel-title">Info</h3>
    </div>
    <div class="panel-body" style="height:83%; overflow:auto;">          
    </div>
</div>
<!-- Output -->
<div class="panel panel-primary"  style="margin:0px;height: 66%">
    <div class="panel-heading">
        <h3 class="panel-title">Recommended domains</h3>
    </div>
    <div class="panel-body" style="height:83%; overflow:auto;">          
            {%for line in data%}
	<br>{{line}}<br>
	{% endfor %}
    </div>
</div>
</div>
{% endif %}
<div class="col-md-6" style="padding:0px;padding-right:20px;height:100%">
<div class="panel panel-info"  style="margin:0px;height: 30%">
    <div class="panel-heading">
        <h3 class="panel-title">Select effect of each metric on recommender</h3>
    </div>
    <div class="panel-body" style="height:100%">
        <div class="row">
            <div class="col-md-6"> 
            <form role="form" action="/search" method="post" name="slider">     
        Number of relevant links:<br><div style="margin-bottom:10px">0%<input type="text" id ="links_slider" class="span2" value="" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="50" data-slider-orientation="horizontal" data-slider-selection="after" data-slider-tooltip="hide">100%</div><br>
        Alexa rank:<br><div style="margin-bottom:10px">0%<input type="text" id ="alexa_slider" class="span2" value="" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="50" data-slider-orientation="horizontal" data-slider-selection="after" data-slider-tooltip="hide">100%</div><br>
        In Degree:<br><div style="margin-bottom:10px">0%<input type="text" id ="in_slider" class="span2" value="" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="50" data-slider-orientation="horizontal" data-slider-selection="after" data-slider-tooltip="hide">100%</div><br>
            </div>
            <div class="col-md-6"> 
        Out Degree:<br><div style="margin-bottom:10px">0%<input type="text" id ="out_slider" class="span2" value="" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="50" data-slider-orientation="horizontal" data-slider-selection="after" data-slider-tooltip="hide">100%</div><br>
        Self Degree:<br><div style="margin-bottom:10px">0%<input type="text" id ="self_slider" class="span2" value="" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="50" data-slider-orientation="horizontal" data-slider-selection="after" data-slider-tooltip="hide">100%</div><br>
            </form>            
            </div>
        </div>
    </div>
</div>
{% if graph %}
<div class="panel panel-warning"  style="margin:0px;padding:0px;height: 66%">
    <div class="panel-heading">
        <h3 class="panel-title">Releated Subgraph</h3>
    </div>
    <div class="panel-body" style="margin:0px;height:100%">        
		<div id="graph-container" style="width:100%;height: 95%"></div>
    </div>
</div>
{% endif %}
</div>
</div>
{% endblock %}

{% block scripts %}
<script src="static/js/bootstrap-slider.js"></script>
<script src="static/js/sigma_new/src/sigma.core.js"></script>
<script src="static/js/sigma_new/src/conrad.js"></script>
<script src="static/js/sigma_new/src/utils/sigma.utils.js"></script>
<script src="static/js/sigma_new/src/utils/sigma.polyfills.js"></script>
<script src="static/js/sigma_new/src/sigma.settings.js"></script>
<script src="static/js/sigma_new/src/classes/sigma.classes.dispatcher.js"></script>
<script src="static/js/sigma_new/src/classes/sigma.classes.configurable.js"></script>
<script src="static/js/sigma_new/src/classes/sigma.classes.graph.js"></script>
<script src="static/js/sigma_new/src/classes/sigma.classes.camera.js"></script>
<script src="static/js/sigma_new/src/classes/sigma.classes.quad.js"></script>
<script src="static/js/sigma_new/src/captors/sigma.captors.mouse.js"></script>
<script src="static/js/sigma_new/src/captors/sigma.captors.touch.js"></script>
<script src="static/js/sigma_new/src/renderers/sigma.renderers.canvas.js"></script>
<script src="static/js/sigma_new/src/renderers/sigma.renderers.webgl.js"></script>
<script src="static/js/sigma_new/src/renderers/sigma.renderers.def.js"></script>
<script src="static/js/sigma_new/src/renderers/webgl/sigma.webgl.nodes.def.js"></script>
<script src="static/js/sigma_new/src/renderers/webgl/sigma.webgl.nodes.fast.js"></script>
<script src="static/js/sigma_new/src/renderers/webgl/sigma.webgl.edges.def.js"></script>
<script src="static/js/sigma_new/src/renderers/webgl/sigma.webgl.edges.fast.js"></script>
<script src="static/js/sigma_new/src/renderers/webgl/sigma.webgl.edges.arrow.js"></script>
<script src="static/js/sigma_new/src/renderers/canvas/sigma.canvas.labels.def.js"></script>
<script src="static/js/sigma_new/src/renderers/canvas/sigma.canvas.hovers.def.js"></script>
<script src="static/js/sigma_new/src/renderers/canvas/sigma.canvas.nodes.def.js"></script>
<script src="static/js/sigma_new/src/renderers/canvas/sigma.canvas.edges.def.js"></script>
<script src="static/js/sigma_new/src/renderers/canvas/sigma.canvas.edges.curve.js"></script>
<script src="static/js/sigma_new/src/renderers/canvas/sigma.canvas.edges.arrow.js"></script>
<script src="static/js/sigma_new/src/renderers/canvas/sigma.canvas.edges.curvedArrow.js"></script>
<script src="static/js/sigma_new/src/middlewares/sigma.middlewares.rescale.js"></script>
<script src="static/js/sigma_new/src/middlewares/sigma.middlewares.copy.js"></script>
<script src="static/js/sigma_new/src/misc/sigma.misc.animation.js"></script>
<script src="static/js/sigma_new/src/misc/sigma.misc.bindEvents.js"></script>
<script src="static/js/sigma_new/src/misc/sigma.misc.drawHovers.js"></script>
<script src="static/js/sigma_new/plugins/sigma.layout.forceAtlas2/worker.js"></script>
<script src="static/js/sigma_new/plugins/sigma.layout.forceAtlas2/supervisor.js"></script>
<!-- END SIGMA IMPORTS -->
<script src="static/js/sigma_new/plugins/sigma.parsers.json/sigma.parsers.json.js"></script>
<script>
// sliders
$('#links_slider').slider()
$('#alexa_slider').slider()
$('#in_slider').slider()
$('#out_slider').slider()
$('#self_slider').slider()
// typeahead
$('#add_pos_domain').typeahead({
    source: {{all_domains|tojson}}
});
$('#add_neg_domain').typeahead({
    source: {{all_domains|tojson}}
});
// Graph
 // these are just some preliminary settings
{% if graph %}

   var g = {{graph|tojson}};

   // Create new Sigma instance in graph-container div (use your div name here) 
   s = new sigma({
   graph: g,
   container: 'graph-container',
	settings: {
	    drawEdges: true
	  },
   renderer: {
    container: document.getElementById('graph-container'),
    type: 'canvas'
   },
   settings: {
    minNodeSize: 5,
    maxNodeSize: 20
    } 
   });
   // first you load a json with (important!) s parameter to refer to the sigma instance   
   
   // Refresh the display:
    s.refresh();

    // ForceAtlas Layout
    s.configForceAtlas2({edgeWeightInfluence: 0.5, gravity:0.1,adjustSized: true, slowDown: 10})
    s.startForceAtlas2();
	// run for max 2 sec
	//setTimeout(function() { s.stopForceAtlas2(); }, 2000);


{% endif %}   
</script>
   
{% endblock %}
